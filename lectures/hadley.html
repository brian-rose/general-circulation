

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>8. Theories of the Hadley circulation &#8212; ATM 622: General Circulation of the Atmosphere</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/hadley';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9. Effect of eddies on the zonal mean circulation" href="tem.html" />
    <link rel="prev" title="7. Available Potential Energy" href="ape.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ATM 622: General Circulation of the Atmosphere - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ATM 622: General Circulation of the Atmosphere - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    ATM 622: General Circulation of the Atmosphere
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course info</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../info/syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info/schedule.html">Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info/how-to.html">How to use this book</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="radiation-budget.html">1. Earth’s radiation budget</a></li>
<li class="toctree-l1"><a class="reference internal" href="computing-seasonal.html">2. Computing seasonal and monthly means from CFSR data</a></li>
<li class="toctree-l1"><a class="reference internal" href="observed-circulation.html">3. The observed circulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="decomposing-circulation.html">4. Decompositions of the circulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="angular-momentum-budget.html">5. Angular Momentum Budget</a></li>
<li class="toctree-l1"><a class="reference internal" href="energy-budget.html">6. Energy Budget</a></li>
<li class="toctree-l1"><a class="reference internal" href="ape.html">7. Available Potential Energy</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">8. Theories of the Hadley circulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tem.html">9. Effect of eddies on the zonal mean circulation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Assignments and labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../assignments/assignment-toa-budget.html">1. Top-of-Atmosphere Radiation Budget and Meridional Energy Transport</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The stuff at the end</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../info/dask_test.html">Benchmarking a data-intensive operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info/dask_test_snow.html">Benchmarking a data-intensive operation (snow version)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../info/references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://lore.atmos.albany.edu:8000/hub/user-redirect/git-pull?repo=https%3A//github.com/brian-rose/general-circulation&urlpath=lab/tree/general-circulation/./lectures/hadley.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/brian-rose/general-circulation" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/brian-rose/general-circulation/issues/new?title=Issue%20on%20page%20%2Flectures/hadley.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/hadley.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Theories of the Hadley circulation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-governing-equations">Assumptions and governing equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#governing-equations">Governing equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-radiative-convective-equilibrium-temperature-profile">The radiative-convective equilibrium temperature profile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frictional-solution-pure-radiative-convective-equilibrium">Frictional solution: pure radiative-convective equilibrium</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-the-zonal-wind-profile">Solving for the zonal wind profile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#profile-of-absolute-angular-momentum">Profile of absolute angular momentum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extensions-of-the-zonally-symmetric-theory">Extensions of the zonally symmetric theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effects-of-moisture">Effects of moisture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effects-of-seasonality">Effects of seasonality</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#does-the-upper-branch-actually-conserve-angular-momentum">Does the upper branch actually conserve angular momentum?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-overturning-streamfunction">Calculate the overturning streamfunction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-absolute-angular-momentum">Calculate the absolute angular momentum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-plot-of-the-overturning-circulation-overlain-on-the-angular-momentum-contours">Make a plot of the overturning circulation overlain on the angular momentum contours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effects-of-eddies-on-the-hadley-cell-qualitative-and-diagnostic-arguments">Effects of eddies on the Hadley cell: qualitative and diagnostic arguments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eddies-in-the-angular-momentum-budget">Eddies in the angular momentum budget</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-observed-eddy-momentum-flux">The observed eddy momentum flux</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-effects-of-eddies">Thermodynamic effects of eddies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-idealized-eddy-driven-hadley-cell-model">An idealized eddy-driven Hadley cell model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-boussinesq-equations">Zonally averaged Boussinesq equations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#momentum">Momentum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamics">Thermodynamics</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-a-balanced-overturning-circulation">Derivation of a balanced overturning circulation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-wind">Thermal wind</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-overturning-streamfunction">Define the overturning streamfunction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-hadley-cell-results">Summary of Hadley Cell results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-angular-momentum-conserving-model">The angular-momentum-conserving model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-eddy-driven-model">The eddy-driven model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mid-latitude-ferrel-cell">The mid-latitude Ferrel cell</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-argument-for-equatorward-flow-in-the-upper-branch">Basic argument for equatorward flow in the upper branch</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-role-of-surface-friction">The role of surface friction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-word">Final word</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="theories-of-the-hadley-circulation">
<h1><span class="section-number">8. </span>Theories of the Hadley circulation<a class="headerlink" href="#theories-of-the-hadley-circulation" title="Permalink to this heading">#</a></h1>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p>So far we’ve seen that the atmospheric circulation in the low latitudes is dominated by the zonally-symmetric overturning, while away from the equator the eddies tend to dominate.</p>
<p>We’ve seen that there is a seamless transport of energy from the equator to the poles, despite the fact that the dominant transport mechanism changes from the MMC in the tropics to transient eddies in mid-latitudes.</p>
<p>Some questions we’d like to get physical insight into:</p>
<ul class="simple">
<li><p>What determines the strength of the Hadley circulation?</p></li>
<li><p>What determines the meridional extend of the Hadley circulation?</p></li>
<li><p>Can the Hadley circulation exist in the absence of eddies?</p></li>
<li><p>What roles are played by differential heating and eddies in the maintenance of the Hadley circulation?</p></li>
</ul>
<p>To start to answer these questions, we follow the classic paper by Held and Hou <span id="id1">[<a class="reference internal" href="../info/references.html#id12" title="Isaac M. Held and Arthur Y. Hou. Nonlinear axially symmetric circulations in a nearly inviscid atmosphere. J. Atmos. Sci., 37:515–533, March 1980. doi:10.1175/1520-0469(1980)037&lt;0515:NASCIA&gt;2.0.CO;2.">Held and Hou, 1980</a>]</span>.</p>
<p>A very readable summary of these ideas is in Vallis “Atmospheric and Oceanic Fluid Dynamics” <span id="id2">[<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">Vallis, 2017</a>]</span> (Chapter 14 of 2nd edition, or chapter 11 of the 1st edition). See also Chapter 7 of <span id="id3">Lindzen [<a class="reference internal" href="../info/references.html#id13" title="Richard S. Lindzen. Dynamics in Atmospheric Physics. Cambridge University Press, Cambridge, 1990.">1990</a>]</span>.</p>
</section>
<section id="assumptions-and-governing-equations">
<h2>Assumptions and governing equations<a class="headerlink" href="#assumptions-and-governing-equations" title="Permalink to this heading">#</a></h2>
<p>We will make the following assumptions</p>
<ul class="simple">
<li><p>We can model the troposphere as a Boussinesq system of depth <span class="math notranslate nohighlight">\(H\)</span> (where <span class="math notranslate nohighlight">\(H\)</span> is the tropopause height) on a sphere</p></li>
<li><p>The flow is <em>steady in time</em></p></li>
<li><p>The flow is <em>zonally symmetric</em>, i.e. it has no variations in longitude</p></li>
<li><p>Turbulence and frictional effects can be modeled by a vertical down-gradient diffusion</p></li>
<li><p>Diabatic heating can be modeled by a Newtonian relaxation to a reference profile with a constant timescale <span class="math notranslate nohighlight">\(\tau\)</span></p></li>
</ul>
<section id="governing-equations">
<h3>Governing equations<a class="headerlink" href="#governing-equations" title="Permalink to this heading">#</a></h3>
<p>We’ll define the zonally symmetric overturning circulation vector</p>
<div class="math notranslate nohighlight">
\[ \vec{v} = (v,w) \]</div>
<p>And write the governing set of equations like this:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\text{Momentum:} &amp; &amp; \nabla\cdot (\vec{v} u) - \left( f + \frac{u \tan\phi}{a} \right) v &amp;= \frac{\partial}{\partial z} \left( \nu \frac{\partial u}{\partial z} \right) \\
&amp; &amp; (\vec{v} v) + \left( f + \frac{u \tan\phi}{a} \right) u &amp;= -\frac{1}{a}\frac{\partial \Phi}{\partial \phi} + \frac{\partial}{\partial z} \left( \nu \frac{\partial v}{\partial z} \right) \\
\text{Continuity} &amp; &amp; \nabla \cdot \vec{v} &amp;= 0 \\
\text{Thermodynamic} &amp; &amp; \nabla \cdot ( \vec{v} \theta ) &amp;= \frac{\partial}{\partial z} \left( \nu \frac{\partial \theta}{\partial z} \right) - \frac{(\theta-\theta_{eq})}{\tau} \\
\text{Hydrostatic} &amp; &amp; \frac{\partial \Phi}{\partial z} &amp;= g \frac{\theta}{\theta_0} 
\end{align*}\]</div>
<p>Here recall that the Boussinesq pressure is</p>
<div class="math notranslate nohighlight">
\[\Phi = \frac{p}{\rho_0} \]</div>
<p>and <span class="math notranslate nohighlight">\(\theta_0, \rho_0\)</span> are reference values.</p>
<p>An appropriate radiative relaxation timescale for the troposphere is <span class="math notranslate nohighlight">\(\tau \approx 30\)</span> days.</p>
</section>
<section id="the-radiative-convective-equilibrium-temperature-profile">
<h3>The radiative-convective equilibrium temperature profile<a class="headerlink" href="#the-radiative-convective-equilibrium-temperature-profile" title="Permalink to this heading">#</a></h3>
<p>Following <span id="id4">Held and Hou [<a class="reference internal" href="../info/references.html#id12" title="Isaac M. Held and Arthur Y. Hou. Nonlinear axially symmetric circulations in a nearly inviscid atmosphere. J. Atmos. Sci., 37:515–533, March 1980. doi:10.1175/1520-0469(1980)037&lt;0515:NASCIA&gt;2.0.CO;2.">1980</a>]</span>, we define our equilibrium temperature like this</p>
<div class="math notranslate nohighlight">
\[ \theta_{eq} = \theta_0 \left[ 1 - \Delta_H \sin^2\phi + \Delta_V \left( \frac{z}{H} - \frac{1}{2} \right) \right] \]</div>
<p>where we take</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\theta_0 = 400\)</span> K as a reference potential temperature</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta_H = 0.3\)</span> is the fractional potential temperature drop from equator to pole in radiative-convective equilibrium</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta_V = 0.3\)</span> is the fractional potential temperature drop from <span class="math notranslate nohighlight">\(z=H\)</span> to the surface in radiative-convective equilibrium</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta0</span> <span class="o">=</span> <span class="mf">400.</span>
<span class="n">DeltaH</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">DeltaV</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">H</span> <span class="o">=</span> <span class="mf">10.</span>  <span class="c1"># tropopause height in km -- for illustration purposes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">latarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">181</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">latarray</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="n">latarray</span><span class="p">})</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>

<span class="n">zarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">H</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">zarray</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">zarray</span><span class="p">})</span>

<span class="n">theta_eq</span> <span class="o">=</span> <span class="n">theta0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">DeltaH</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">DeltaV</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">H</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">theta_eq</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x7f0604c31690&gt;
</pre></div>
</div>
<img alt="../_images/d97a747564aecd6e3ae50e2713e9692566efe9cc15421472c0c618ef2f943986.png" src="../_images/d97a747564aecd6e3ae50e2713e9692566efe9cc15421472c0c618ef2f943986.png" />
</div>
</div>
</section>
<section id="boundary-conditions">
<h3>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this heading">#</a></h3>
<p>At the tropopause <span class="math notranslate nohighlight">\(z=H\)</span> we apply <em>no-flow</em> and <em>free-slip</em> conditions:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
w(H) &amp;= 0 \\
\frac{\partial \theta}{\partial z}\Big|_{z=H} &amp;= 0 \\
\frac{\partial u}{\partial z}\Big|_{z=H} &amp; = 0 \\
\frac{\partial v}{\partial z}\Big|_{z=H} &amp; = 0 
\end{align*}\]</div>
<p>At the surface, we apply <em>no-flow</em> and a simple Rayleigh drag condition:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
w(0) &amp;= 0 \\
\frac{\partial \theta}{\partial z}\Big|_{z=0} &amp;= 0 \\
\nu\frac{\partial u}{\partial z}\Big|_{z=0} &amp; = c u \\
\nu\frac{\partial v}{\partial z}\Big|_{z=0} &amp; = c v 
\end{align*}\]</div>
<p>Finally, we impose <em>interhemispheric symmetry</em> – no cross-equatorial flow:</p>
<div class="math notranslate nohighlight">
\[ v = 0  \]</div>
<p>at <span class="math notranslate nohighlight">\(\phi = 0\)</span>.</p>
</section>
</section>
<section id="frictional-solution-pure-radiative-convective-equilibrium">
<h2>Frictional solution: pure radiative-convective equilibrium<a class="headerlink" href="#frictional-solution-pure-radiative-convective-equilibrium" title="Permalink to this heading">#</a></h2>
<p>First, let’s look at the case of a purely frictionless / non-turbulent flow where</p>
<div class="math notranslate nohighlight">
\[\nu = 0\]</div>
<p>A solution to the governing equations exists for which the flow is purely zonal with no overturning:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
u &amp;= u_{eq} \\
v &amp;= 0 \\
w &amp;= 0
\end{align*}\]</div>
<p>In such a case, the thermodynamic equation tells us that</p>
<div class="math notranslate nohighlight">
\[ \theta = \theta_{eq} \]</div>
<p>everywhere, i.e. the atmosphere is in a state of radiative-convective equilibrium.</p>
<section id="solving-for-the-zonal-wind-profile">
<h3>Solving for the zonal wind profile<a class="headerlink" href="#solving-for-the-zonal-wind-profile" title="Permalink to this heading">#</a></h3>
<p>We would like to see what this model predicts for the vertical and meridional profile of the zonal wind <span class="math notranslate nohighlight">\(u_{eq}\)</span> in the radiative-convective equilibrium state.</p>
<p>The meridional momentum equation becomes</p>
<div class="math notranslate nohighlight">
\[ f u_{eq} + \frac{u_{eq}^2 \tan\phi}{a} = -\frac{1}{a} \frac{\partial \Phi}{\partial \phi} \]</div>
<p>Deriving a thermal wind equation by taking the vertical derivative and using hydrostatic balance:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial z} \left( f u_{eq} + \frac{u_{eq}^2 \tan\phi}{a} \right) = -\frac{g}{a \theta_0} \frac{\partial \theta_{eq}}{\partial \phi}\]</div>
<p>From the definition of <span class="math notranslate nohighlight">\(\theta_{eq}\)</span> we get</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \theta_{eq}}{\partial \phi} = -2\Delta_H \theta_0 \sin\phi \cos\phi \]</div>
<p>So, integrating the thermal wind equation in the vertical and applying the boundary condition <span class="math notranslate nohighlight">\(u_{eq}(0) = 0\)</span>, we get</p>
<div class="math notranslate nohighlight">
\[f u_{eq} + \frac{u_{eq}^2 \tan\phi}{a} = \frac{2 g \Delta_H}{a} \sin\phi \cos\phi z\]</div>
<p>which is a quadratic equation in <span class="math notranslate nohighlight">\(u_{eq}\)</span> that we can solve:</p>
<div class="math notranslate nohighlight">
\[u_{eq} = \Omega a \cos\phi \left( \sqrt{1 + \frac{2 z}{H} \left(\frac{g H \Delta_H}{(\Omega a)^2}\right)} - 1 \right)\]</div>
<p>… more to come</p>
</section>
<section id="profile-of-absolute-angular-momentum">
<h3>Profile of absolute angular momentum<a class="headerlink" href="#profile-of-absolute-angular-momentum" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[M_eq = \Omega a^2 \cos^2\phi \sqrt{1 + \frac{2z}{H} R_{OT}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sidereal_day</span> <span class="o">=</span> <span class="mf">86164.0905</span>  <span class="c1"># in seconds -- we definitely don&#39;t need this accuracy but hey</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">6.373E6</span>      <span class="c1"># Radius of Earth (m)</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">sidereal_day</span>
<span class="n">uT</span> <span class="o">=</span> <span class="mf">100.</span> <span class="c1"># tropopause-level wind speed in m/s -- order of magnitude estimate</span>

<span class="c1"># The temporal Rossby number</span>
<span class="n">RoT</span> <span class="o">=</span> <span class="n">uT</span> <span class="o">/</span> <span class="n">Omega</span> <span class="o">/</span> <span class="n">a</span>
<span class="n">RoT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2151803062936203
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Meq</span> <span class="o">=</span> <span class="n">Omega</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="n">H</span><span class="o">*</span><span class="n">RoT</span><span class="p">)</span>
<span class="n">Meq</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x7f05fc995930&gt;
</pre></div>
</div>
<img alt="../_images/0731ec125472ca17cbc39947d49f9e1e4921c6ff75f7552ce79551ee44401648.png" src="../_images/0731ec125472ca17cbc39947d49f9e1e4921c6ff75f7552ce79551ee44401648.png" />
</div>
</div>
<p>The key point here is the existence of a local maximum of absolute angular momentum away from the surface, which cannot exist in a fluid with any viscosity at all.</p>
<p>… more to come in these notes</p>
</section>
</section>
<section id="extensions-of-the-zonally-symmetric-theory">
<h2>Extensions of the zonally symmetric theory<a class="headerlink" href="#extensions-of-the-zonally-symmetric-theory" title="Permalink to this heading">#</a></h2>
<section id="effects-of-moisture">
<h3>Effects of moisture<a class="headerlink" href="#effects-of-moisture" title="Permalink to this heading">#</a></h3>
<p>We made a severe simplication of the dynamics of the equatorial region by ignoring the latent heating due to condensation in our thermodynamic equation. Is it possible to extend the zonally symmetric, angular-momentum-conserving theory to account for the fact that condensation is large in our upward branch of the circulation?</p>
<p>Vallis discusses this in section 14.2.7 of his “big book” (2nd edition) <span id="id5">[<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">Vallis, 2017</a>]</span>.</p>
<p>We suppose the Hadley cell circulation represents a closed system for water, in which the latent heating by condensation in the upward branch is exactly balanced by the energy required to evaporate water off the surface. This represents an additional energy redistribution process within the cell, but the cell must still conserve energy so that</p>
<div class="math notranslate nohighlight">
\[\int_0^{\phi_H} &lt;\theta&gt; \cos\phi d\phi = \int_0^{\phi_H} &lt;\theta_{eq}&gt; \cos\phi d\phi\]</div>
<p>still holds.</p>
<p>To actually solve a model like this, we would need to make the equilibrium profile <span class="math notranslate nohighlight">\(\theta_{eq}\)</span> a function of the circulation itself, making the problem non-linear and substantially more complicated.</p>
<p>The basic idea is that <span class="math notranslate nohighlight">\(\theta_{eq}\)</span> would now have a strong peak near the equator. As a consequence, the heating profile <span class="math notranslate nohighlight">\(\theta - \theta_{eq}\)</span> would have a strong equator-to-subtropical gradient, and the resulting Hadley circulation must therefore be stronger.</p>
<p>Another consequence (borne out by numerical modeling) is that the upward branch of the moist Hadley circulation should become much narrower and more intense.</p>
<figure class="align-default" id="markdown-fig">
<a class="reference internal image-reference" href="../_images/Vallis_fig14.8.pdf"><img alt="Schema of the effects of moisture on a model of the Hadley Cell" src="../_images/Vallis_fig14.8.pdf" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.1 </span><span class="caption-text">Source: <span id="id6">Vallis [<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">2017</a>]</span> (Figure 14.8 of the 2nd edition). Note that in Vallis’s notation, <span class="math notranslate nohighlight">\(\theta_{E}\)</span> is the dry radiative equilibrium temperature and <span class="math notranslate nohighlight">\(\theta_{E}^*\)</span> is the moist radiative equilibrium.</span><a class="headerlink" href="#markdown-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="effects-of-seasonality">
<h3>Effects of seasonality<a class="headerlink" href="#effects-of-seasonality" title="Permalink to this heading">#</a></h3>
<p>Observations show that the circulation is dominated by a single winter cell, and rising motion in the summer hemisphere near the soltices.</p>
<p>The zonally symmetric theory was extended to the case where the heating is centered off the equator at a latitude <span class="math notranslate nohighlight">\(\phi_0\)</span> by <span id="id7">Lindzen and Hou [<a class="reference internal" href="../info/references.html#id14" title="Richard S. Lindzen and Arthur Y. Hou. Hadley circulations for zonally averaged heating centered off the equator. J. Atmos. Sci., 45(17):2416–2427, September 1988. doi:10.1175/1520-0469(1988)045&lt;2416:HCFZAH&gt;2.0.CO;2.">1988</a>]</span>. This is reviewed in Section 14.4 of <span id="id8">Vallis [<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">2017</a>]</span>:</p>
<figure class="align-default" id="id10">
<a class="reference internal image-reference" href="../_images/Vallis_fig14.9.pdf"><img alt="Schematic of a Hadley circulation model when the heating is centered off the equator" src="../_images/Vallis_fig14.9.pdf" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.2 </span><span class="caption-text">Source: <span id="id9">Vallis [<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">2017</a>]</span> (Figure 14.9 of the 2nd edition).</span><a class="headerlink" href="#id10" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>A solution is possible following similar procedures but applying multiple boundary conditions.</p>
<p>The structure of the temperature field becomes</p>
<div class="math notranslate nohighlight">
\[ &lt;\theta&gt;(\phi) - &lt;\theta&gt;(\phi_1) = -\frac{\theta_0 \Omega^2 a^2}{2 g H} \frac{(\sin^2\phi - \sin^2)^2}{\cos^2\phi}\]</div>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="../_images/Vallis_fig14.10.pdf"><img alt="Solutions of a Hadley circulation model when the heating is centered off the equator" src="../_images/Vallis_fig14.10.pdf" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.3 </span><span class="caption-text">Source: <span id="id11">Vallis [<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">2017</a>]</span> (Figure 14.10 of the 2nd edition).</span><a class="headerlink" href="#id12" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The solution shows that the circulation in the winter hemisphere is much stronger, at least qualitatively consistent with observations. See <span id="id13">Dima and Wallace [<a class="reference internal" href="../info/references.html#id15" title="Ioana M. Dima and John M. Wallace. On the seasonality of the hadley cell. J. Atmos. Sci., 60:1522–1527, 2003. doi:10.1175/1520-0469(2003)060&lt;1522:OTSOTH&gt;2.0.CO;2.">2003</a>]</span> for a critical discussion.</p>
</section>
</section>
<section id="does-the-upper-branch-actually-conserve-angular-momentum">
<h2>Does the upper branch actually conserve angular momentum?<a class="headerlink" href="#does-the-upper-branch-actually-conserve-angular-momentum" title="Permalink to this heading">#</a></h2>
<p>The simple models we’ve looked at here all rest of the basic assumption that there are no eddies in the flow, and that (therefore) the poleward flowing branch conserves its absolute angular momentum.</p>
<p>Let’s take a quick look at reanalysis data, using our <a class="reference external" href="https://brian-rose.github.io/general-circulation/lectures/computing-seasonal.html">pre-computed monthly climatologies</a> of the CFSR data.</p>
<section id="calculate-the-overturning-streamfunction">
<h3>Calculate the overturning streamfunction<a class="headerlink" href="#calculate-the-overturning-streamfunction" title="Permalink to this heading">#</a></h3>
<p>Repeating here some code from our notes on the <a class="reference external" href="https://brian-rose.github.io/general-circulation/lectures/observed-circulation.html#mass-overturning-circulation">Observed circulation</a> to calculate the mass climatological overturning streamfunction <span class="math notranslate nohighlight">\(\psi\)</span>, defined by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
2\pi a \cos\phi [\overline{v}] &amp;= \frac{\partial \psi}{\partial p} \\
2\pi a^2 \cos\phi \left( [\overline{\omega}]\right) = -\frac{\partial \psi}{\partial \phi}
\end{align*}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">climlab.utils.constants</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">g</span>

<span class="n">local_path</span> <span class="o">=</span> <span class="s1">&#39;/nfs/roselab_rit/data/cfsr_climatology/&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">local_path</span>

<span class="n">cfsr_mon</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span> <span class="o">+</span> <span class="s1">&#39;.mon_clim.0p5.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vbracket</span> <span class="o">=</span> <span class="n">cfsr_mon</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
<span class="n">vbracket_zeros</span> <span class="o">=</span> <span class="n">vbracket</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">cfsr_mon</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>
<span class="c1"># Use units of 10^9 kg/s</span>
<span class="n">psi</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">coslat</span><span class="o">/</span><span class="n">g</span> <span class="o">*</span> <span class="n">vbracket_zeros</span><span class="o">.</span><span class="n">cumulative_integrate</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1E9</span> <span class="o">*</span> <span class="mi">100</span>
<span class="c1"># Need to multiply by 100 because the &#39;lev&#39; coordinate is in units of hPa, not Pa</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-absolute-angular-momentum">
<h3>Calculate the absolute angular momentum<a class="headerlink" href="#calculate-the-absolute-angular-momentum" title="Permalink to this heading">#</a></h3>
<p>Following our <a class="reference external" href="https://brian-rose.github.io/general-circulation/lectures/angular-momentum-budget.html">angular momentum notes</a>, we can easily calculate the climatological absolute angular momentum:</p>
<div class="math notranslate nohighlight">
\[ M = \Omega a^2 \cos^2\phi + u a \cos\phi \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sidereal_period</span> <span class="o">=</span> <span class="p">(</span><span class="mi">23</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mi">56</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mf">4.09053</span>  <span class="c1"># Earth&#39;s rotational period in seconds -- just shy of one day</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">sidereal_period</span>  <span class="c1"># Earth&#39;s angular rotation rate (radians / second)</span>

<span class="n">Mplanetary</span> <span class="o">=</span> <span class="n">Omega</span> <span class="o">*</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">coslat</span> <span class="o">/</span> <span class="mf">1E7</span> <span class="c1"># put in units of 10^6 m^2 s^-1</span>
<span class="n">Mplanetary</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;planetary angular momentum&#39;</span>

<span class="n">ubracket</span> <span class="o">=</span> <span class="n">cfsr_mon</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>

<span class="n">Mrelative</span> <span class="o">=</span> <span class="n">ubracket</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">coslat</span> <span class="o">/</span> <span class="mf">1E7</span>
<span class="n">Mrelative</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;relative angular momentum&#39;</span>

<span class="n">Mabsolute</span> <span class="o">=</span> <span class="n">Mplanetary</span> <span class="o">+</span> <span class="n">Mrelative</span>
<span class="n">Mabsolute</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;aboslute angular momentum&#39;</span>

<span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Mplanetary</span><span class="p">,</span> <span class="n">Mrelative</span><span class="p">,</span> <span class="n">Mabsolute</span><span class="p">]:</span>
    <span class="n">M</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10^7 m^2 s^-1&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-a-plot-of-the-overturning-circulation-overlain-on-the-angular-momentum-contours">
<h3>Make a plot of the overturning circulation overlain on the angular momentum contours<a class="headerlink" href="#make-a-plot-of-the-overturning-circulation-overlain-on-the-angular-momentum-contours" title="Permalink to this heading">#</a></h3>
<p>We will plot the seasonal extremes December and January</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">240</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)</span>
<span class="n">M_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">CSpsi</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                       <span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> 
                                       <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">levels</span><span class="o">=</span><span class="n">psi_levels</span><span class="p">,</span>
                                       <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                                            <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CSpsi</span><span class="p">,</span> <span class="n">CSpsi</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">CSm</span> <span class="o">=</span> <span class="n">Mabsolute</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                       <span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> 
                                       <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">levels</span><span class="o">=</span><span class="n">M_levels</span><span class="p">,</span>
                                       <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;dimgray&#39;</span><span class="p">,</span>
                                            <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CSm</span><span class="p">,</span> <span class="n">CSm</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Mass streamfunction (blue, 10$^9$ kg s$^{-1}$) and absolute angular momentum (gray, 10$^7$ m$^2$ s$^-1$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/52d209429b5cf608156ac9d1684a3d94eadeee51b55bbec79d5147bb26b53f4b.png" src="../_images/52d209429b5cf608156ac9d1684a3d94eadeee51b55bbec79d5147bb26b53f4b.png" />
</div>
</div>
<p>Notice how the <span class="math notranslate nohighlight">\(M\)</span> contours “bulge out” in the poleward direction in the upper troposphere, especially in the subtropics of the winter hemisphere!</p>
<p>This suggests that the observed circulation does advect high equatorial <span class="math notranslate nohighlight">\(M\)</span> poleward and to some extent conserves <span class="math notranslate nohighlight">\(M\)</span> in the poleward branch. But a truly conservative circulation would not cross any <span class="math notranslate nohighlight">\(M\)</span> contours.</p>
<p>We can see in these figures that the blue <span class="math notranslate nohighlight">\(\psi\)</span> contours do indeed cross gray <span class="math notranslate nohighlight">\(M\)</span> contours in the upper branches, indicating that <strong>zonal-mean angular momentum is not really conserved</strong> in these circulations.</p>
<p>This, in turn, suggests an important role for the eddies that we have so far neglected.</p>
</section>
</section>
<section id="effects-of-eddies-on-the-hadley-cell-qualitative-and-diagnostic-arguments">
<h2>Effects of eddies on the Hadley cell: qualitative and diagnostic arguments<a class="headerlink" href="#effects-of-eddies-on-the-hadley-cell-qualitative-and-diagnostic-arguments" title="Permalink to this heading">#</a></h2>
<section id="eddies-in-the-angular-momentum-budget">
<h3>Eddies in the angular momentum budget<a class="headerlink" href="#eddies-in-the-angular-momentum-budget" title="Permalink to this heading">#</a></h3>
<p>Let’s write a zonally averaged angular momentum equation including the (so-far) neglected eddy terms.</p>
<p>Start from absolute angular momentum conservation</p>
<div class="math notranslate nohighlight">
\[ \frac{DM}{Dt} = 0 \]</div>
<p>and write in flux form. If we take the zonal average, we get flux contributions from the mean meridional circulation <span class="math notranslate nohighlight">\([v][M]\)</span> and the zonal eddy flux <span class="math notranslate nohighlight">\([v^* M^*]\)</span>. The equation then looks like</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [M]}{\partial t} + \frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} ( [v] [M] \cos\phi ) + \frac{\partial}{\partial z} ([w][M]) = -\frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} ( [v^* M^*] \cos\phi ) - \frac{\partial}{\partial z} ( [w^*M^*])\]</div>
<p>where we moved the eddy flux terms over to the RHS of the equation <strong>because we are treating the eddies are forcing on the zonal mean flow</strong>.</p>
<p>For simplicity here we’ll stay in the Boussinesq framework, and we’ll ignore the vertical flux entirely.</p>
<p>Since the absolute angular momentum is related to the zonal wind</p>
<div class="math notranslate nohighlight">
\[ M = \Omega a^2 \cos^2 \phi + u a \cos\phi \]</div>
<p>the eddy momentum flux <span class="math notranslate nohighlight">\([v^*M^*]\)</span> can be written as <span class="math notranslate nohighlight">\([u^* v^*] a \cos\phi\)</span>, and so our equation becomes</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [M]}{\partial t} + \frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} ( [v] [M] \cos\phi ) = -\frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} ( [u^* v^*] a \cos^2\phi ) \]</div>
<p>or, since the Boussinesq fluid is non-divergent and we are ignoring vertical fluxes, we can also write this as</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [M]}{\partial t} + \frac{[v]}{a \cos\phi} \frac{\partial}{\partial \phi} ( [M] \cos\phi ) = -\frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} ( [u^* v^*] a \cos^2\phi ) \]</div>
<p>This shows that regions where the eddy momentum flux <em>diverges</em>, the eddies tend to reduce the zonal-mean angular momentum <span class="math notranslate nohighlight">\([M]\)</span>. Conversely, the eddies tend to increase <span class="math notranslate nohighlight">\([M]\)</span> where the eddy momentum flux is convergent.</p>
</section>
<section id="the-observed-eddy-momentum-flux">
<h3>The observed eddy momentum flux<a class="headerlink" href="#the-observed-eddy-momentum-flux" title="Permalink to this heading">#</a></h3>
<p>Let’s plot the eddy momentum flux <span class="math notranslate nohighlight">\([u^* v^*] \cos\phi\)</span> for the month of January to get a sense of how the observed circulation must be affecting the angular momentum of the winter-season Hadley cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfsr_path</span> <span class="o">=</span> <span class="s1">&#39;/cfsr/data/&#39;</span>
<span class="n">year</span> <span class="o">=</span> <span class="s1">&#39;2021&#39;</span>

<span class="n">u_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cfsr_path</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;/u.&#39;</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;.0p5.anl.nc&#39;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lev&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="n">v_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cfsr_path</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;/v.&#39;</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;.0p5.anl.nc&#39;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lev&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_6hourly</span> <span class="o">=</span> <span class="n">u_ds</span><span class="o">.</span><span class="n">u</span>
<span class="n">v_6hourly</span> <span class="o">=</span> <span class="n">v_ds</span><span class="o">.</span><span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bracket</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">star</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span> <span class="o">-</span> <span class="n">bracket</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">u_ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">prime</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">u_ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">-</span> <span class="n">bar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">momentumflux</span> <span class="o">=</span> <span class="n">bracket</span><span class="p">(</span><span class="n">star</span><span class="p">(</span><span class="n">u_6hourly</span><span class="p">)</span><span class="o">*</span><span class="n">star</span><span class="p">(</span><span class="n">v_6hourly</span><span class="p">))</span> <span class="o">*</span> <span class="n">coslat</span>
<span class="n">momentumflux</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 1460, lev: 32, lat: 361)&gt;
dask.array&lt;mul, shape=(1460, 32, 361), dtype=float32, chunksize=(30, 4, 361), chunktype=numpy.ndarray&gt;
Coordinates:
  * time     (time) datetime64[ns] 2021-01-01 ... 2021-12-31T18:00:00
  * lat      (lat) float32 -90.0 -89.5 -89.0 -88.5 -88.0 ... 88.5 89.0 89.5 90.0
  * lev      (lev) float32 1e+03 975.0 950.0 925.0 900.0 ... 50.0 30.0 20.0 10.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1460</li><li><span class='xr-has-index'>lev</span>: 32</li><li><span class='xr-has-index'>lat</span>: 361</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-37eeb3ac-5214-4386-988e-ef5f99dc22b7' class='xr-array-in' type='checkbox' checked><label for='section-37eeb3ac-5214-4386-988e-ef5f99dc22b7' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(30, 4, 361), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 64.34 MiB </td>
                        <td> 169.22 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (1460, 32, 361) </td>
                        <td> (30, 4, 361) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 19 Graph Layers </td>
                        <td> 392 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="173" height="150" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="3" x2="80" y2="74" />
  <line x1="10" y1="7" x2="80" y2="77" />
  <line x1="10" y1="11" x2="80" y2="81" />
  <line x1="10" y1="14" x2="80" y2="85" />
  <line x1="10" y1="18" x2="80" y2="89" />
  <line x1="10" y1="22" x2="80" y2="92" />
  <line x1="10" y1="25" x2="80" y2="96" />
  <line x1="10" y1="29" x2="80" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="29" style="stroke-width:2" />
  <line x1="12" y1="2" x2="12" y2="32" />
  <line x1="17" y1="7" x2="17" y2="36" />
  <line x1="20" y1="10" x2="20" y2="39" />
  <line x1="24" y1="14" x2="24" y2="44" />
  <line x1="27" y1="17" x2="27" y2="46" />
  <line x1="31" y1="21" x2="31" y2="51" />
  <line x1="36" y1="26" x2="36" y2="55" />
  <line x1="39" y1="29" x2="39" y2="58" />
  <line x1="43" y1="33" x2="43" y2="62" />
  <line x1="46" y1="36" x2="46" y2="65" />
  <line x1="50" y1="40" x2="50" y2="70" />
  <line x1="53" y1="43" x2="53" y2="73" />
  <line x1="57" y1="47" x2="57" y2="77" />
  <line x1="62" y1="52" x2="62" y2="81" />
  <line x1="65" y1="55" x2="65" y2="84" />
  <line x1="69" y1="59" x2="69" y2="89" />
  <line x1="72" y1="62" x2="72" y2="91" />
  <line x1="76" y1="66" x2="76" y2="96" />
  <line x1="80" y1="70" x2="80" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,100.13852457018754 10.0,29.550289276069893" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="52" y2="0" style="stroke-width:2" />
  <line x1="12" y1="2" x2="55" y2="2" />
  <line x1="17" y1="7" x2="60" y2="7" />
  <line x1="20" y1="10" x2="63" y2="10" />
  <line x1="24" y1="14" x2="67" y2="14" />
  <line x1="27" y1="17" x2="70" y2="17" />
  <line x1="31" y1="21" x2="74" y2="21" />
  <line x1="36" y1="26" x2="78" y2="26" />
  <line x1="39" y1="29" x2="81" y2="29" />
  <line x1="43" y1="33" x2="86" y2="33" />
  <line x1="46" y1="36" x2="89" y2="36" />
  <line x1="50" y1="40" x2="93" y2="40" />
  <line x1="53" y1="43" x2="96" y2="43" />
  <line x1="57" y1="47" x2="100" y2="47" />
  <line x1="62" y1="52" x2="105" y2="52" />
  <line x1="65" y1="55" x2="107" y2="55" />
  <line x1="69" y1="59" x2="112" y2="59" />
  <line x1="72" y1="62" x2="115" y2="62" />
  <line x1="76" y1="66" x2="119" y2="66" />
  <line x1="80" y1="70" x2="123" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="52" y1="0" x2="123" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 52.85744577221065,0.0 123.4456810663283,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="123" y2="70" style="stroke-width:2" />
  <line x1="80" y1="74" x2="123" y2="74" />
  <line x1="80" y1="77" x2="123" y2="77" />
  <line x1="80" y1="81" x2="123" y2="81" />
  <line x1="80" y1="85" x2="123" y2="85" />
  <line x1="80" y1="89" x2="123" y2="89" />
  <line x1="80" y1="92" x2="123" y2="92" />
  <line x1="80" y1="96" x2="123" y2="96" />
  <line x1="80" y1="100" x2="123" y2="100" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="100" style="stroke-width:2" />
  <line x1="123" y1="70" x2="123" y2="100" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 123.4456810663283,70.58823529411765 123.4456810663283,100.13852457018754 80.58823529411765,100.13852457018754" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="102.016958" y="120.138525" font-size="1.0rem" font-weight="100" text-anchor="middle" >361</text>
  <text x="143.445681" y="85.363380" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,143.445681,85.363380)">32</text>
  <text x="35.294118" y="84.844407" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,84.844407)">1460</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-b0ce44f0-3be8-454c-a85f-1ad090819b6f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b0ce44f0-3be8-454c-a85f-1ad090819b6f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-01-01 ... 2021-12-31T18:00:00</div><input id='attrs-52b6feba-ce5d-4a92-82f7-2de078944495' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-52b6feba-ce5d-4a92-82f7-2de078944495' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9afd10c2-39ba-480d-a602-ed1831a2694d' class='xr-var-data-in' type='checkbox'><label for='data-9afd10c2-39ba-480d-a602-ed1831a2694d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>actual_range :</span></dt><dd>[1937256. 1946010.]</dd><dt><span>last_time :</span></dt><dd>2021-12-31 18:00:00</dd><dt><span>first_time :</span></dt><dd>2021-1-1 00:00:00</dd><dt><span>delta_t :</span></dt><dd>0000-00-00 06:00:00</dd><dt><span>long_name :</span></dt><dd>initial time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-01-01T00:00:00.000000000&#x27;, &#x27;2021-01-01T06:00:00.000000000&#x27;,
       &#x27;2021-01-01T12:00:00.000000000&#x27;, ..., &#x27;2021-12-31T06:00:00.000000000&#x27;,
       &#x27;2021-12-31T12:00:00.000000000&#x27;, &#x27;2021-12-31T18:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-90.0 -89.5 -89.0 ... 89.5 90.0</div><input id='attrs-7599f94c-8dd1-4ca5-8fec-012c23eb5d50' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7599f94c-8dd1-4ca5-8fec-012c23eb5d50' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50f0ae57-3e2e-4423-816c-b7bc8bf64161' class='xr-var-data-in' type='checkbox'><label for='data-50f0ae57-3e2e-4423-816c-b7bc8bf64161' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>actual_range :</span></dt><dd>[-90  90]</dd><dt><span>delta_y :</span></dt><dd>0.5</dd><dt><span>coordinate_defines :</span></dt><dd>center</dd><dt><span>mapping :</span></dt><dd>cylindrical_equidistant_projection_grid</dd><dt><span>grid_resolution :</span></dt><dd>0.5_degrees</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-90. , -89.5, -89. , ...,  89. ,  89.5,  90. ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1e+03 975.0 950.0 ... 20.0 10.0</div><input id='attrs-f138b730-36d1-4920-b0eb-fcba9d6faa0a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f138b730-36d1-4920-b0eb-fcba9d6faa0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf518350-2281-48e5-bf2d-5abbe7d11725' class='xr-var-data-in' type='checkbox'><label for='data-bf518350-2281-48e5-bf2d-5abbe7d11725' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>hPa</dd><dt><span>long_name :</span></dt><dd>isobaric_level</dd></dl></div><div class='xr-var-data'><pre>array([1000.,  975.,  950.,  925.,  900.,  875.,  850.,  825.,  800.,  775.,
        750.,  700.,  650.,  600.,  550.,  500.,  450.,  400.,  350.,  300.,
        250.,  225.,  200.,  175.,  150.,  125.,  100.,   70.,   50.,   30.,
         20.,   10.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-93811322-4b3b-4ad8-964b-3156640fc6f8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-93811322-4b3b-4ad8-964b-3156640fc6f8' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">momentumflux_jan</span> <span class="o">=</span> <span class="n">bar</span><span class="p">(</span><span class="n">momentumflux</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">momentumflux_jan</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Northward eddy flux of angular momentum&#39;</span>
<span class="n">momentumflux_jan</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m^2 s^-2&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">momflux_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">75</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">momentumflux_jan</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span>
                                   <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">levels</span><span class="o">=</span><span class="n">momflux_levels</span><span class="p">,</span>
                                   <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                                  <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Northward eddy momentum flux $\overline{[u^* v^*]} \cos\phi$ for January 2021 (m$^2$ s$^-2$)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cacb3271c56b83b8b6fd1fa42e9ab285fe4e8969a7a3feba85cb8c79a1687153.png" src="../_images/cacb3271c56b83b8b6fd1fa42e9ab285fe4e8969a7a3feba85cb8c79a1687153.png" />
</div>
</div>
<p>Evidently the eddy momentum flux increases from equator to a maximum at about 30º in the winter hemisphere, so the RHS of our angular momentum equation is negative across the tropics.</p>
<p>Thus if <span class="math notranslate nohighlight">\([v] &gt;0\)</span> (as it is in the upper branch of the Hadley cell) and the flow is steady, then zonal mean angular momemtum <span class="math notranslate nohighlight">\([M]\)</span> must <em>decrease</em> as it moves poleward!</p>
<p>The zonal velocity <span class="math notranslate nohighlight">\([u]\)</span> must be less than it would be in the absence of the observed eddies.</p>
</section>
<section id="thermodynamic-effects-of-eddies">
<h3>Thermodynamic effects of eddies<a class="headerlink" href="#thermodynamic-effects-of-eddies" title="Permalink to this heading">#</a></h3>
<p>Let’s write a zonally-averged thermodynamic equation for the Boussinesq system, again neglecting vertical fluxes (or if you prefer, taking the vertical average):</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [b]}{\partial t} +\frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} ( [v][b]\cos\phi) = -\frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} ( [v^* b^*]\cos\phi) + \dot{Q} \]</div>
<p>where <span class="math notranslate nohighlight">\(\dot{Q}\)</span> is a diabatic heating.</p>
<p>This equation shows that the eddy heat flux divergence has the same effect on the zonal-mean fields as a diabatic heating.</p>
<p>Let’s take a look at the observed eddy heat flux.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cfsr_path</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;/t.&#39;</span> <span class="o">+</span> <span class="n">year</span> <span class="o">+</span> <span class="s1">&#39;.0p5.anl.nc&#39;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;lev&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="n">T_6hourly</span> <span class="o">=</span> <span class="n">T_ds</span><span class="o">.</span><span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heatflux</span> <span class="o">=</span> <span class="n">bracket</span><span class="p">(</span><span class="n">star</span><span class="p">(</span><span class="n">T_6hourly</span><span class="p">)</span><span class="o">*</span><span class="n">star</span><span class="p">(</span><span class="n">v_6hourly</span><span class="p">))</span> <span class="o">*</span> <span class="n">coslat</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heatflux_jan</span> <span class="o">=</span> <span class="n">bar</span><span class="p">(</span><span class="n">heatflux</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">heatflux_jan</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Northward eddy heat flux&#39;</span>
<span class="n">heatflux_jan</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;K m^1 s^-1&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">heatflux_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mf">5.</span><span class="p">)</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">heatflux_jan</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span>
                                   <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">levels</span><span class="o">=</span><span class="n">heatflux_levels</span><span class="p">,</span>
                                   <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                                  <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Northward eddy heat flux $\overline{[v^* T^*]} \cos\phi$ for January 2021 (K m$^1$ s$^-1$)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5f1a8e161335f477158ba493198120fde9fdae7b52dc9e8c6b46a3792850c624.png" src="../_images/5f1a8e161335f477158ba493198120fde9fdae7b52dc9e8c6b46a3792850c624.png" />
</div>
</div>
<p>The eddy heat flux is predominantly poleward, showing that eddies export heat from the subtropics to higher latitudes.</p>
<p>Evidently the observed flux is <em>divergent</em> over the subtropical edge of the Hadley cell. The eddies are thus creating a <em>steeper meridional heating gradient</em> across the Hadley cell and acting to <em>increase the intensity of the overturning</em>.</p>
</section>
</section>
<section id="an-idealized-eddy-driven-hadley-cell-model">
<h2>An idealized eddy-driven Hadley cell model<a class="headerlink" href="#an-idealized-eddy-driven-hadley-cell-model" title="Permalink to this heading">#</a></h2>
<p>We can more formally quantify the above arguments into a model for the Hadley circulation in the purely eddy-driven limit.</p>
<p>So we will now write down equations where we neglect meridional fluxes by the mean flow (like <span class="math notranslate nohighlight">\([u][v]\)</span>) and instead include the eddy fluxes (such as <span class="math notranslate nohighlight">\([u^* v^*]\)</span>.</p>
<section id="zonally-averaged-boussinesq-equations">
<h3>Zonally averaged Boussinesq equations<a class="headerlink" href="#zonally-averaged-boussinesq-equations" title="Permalink to this heading">#</a></h3>
<p>Keeping things simple, we will continue to use Boussinesq equations, ignore vertical fluxes, and also ignore the curvature terms in the momentum equation.</p>
<section id="momentum">
<h4>Momentum<a class="headerlink" href="#momentum" title="Permalink to this heading">#</a></h4>
<p>A zonally averaged zonal momentum equation in this regime looks like</p>
<div class="math notranslate nohighlight">
\[ \frac{D[u]}{Dt} - f[v] = 0\]</div>
<p>or, writing out the material derivative in flux form and moving things over to the RHS,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [u]}{\partial t} &amp;= f[v] -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ([u^*v^*] \cos\phi) \\
&amp;= f[v] - J_u 
\end{align*}\]</div>
<p>defining an eddy source term <span class="math notranslate nohighlight">\(J_u\)</span> that we will be using shortly.</p>
</section>
<section id="thermodynamics">
<h4>Thermodynamics<a class="headerlink" href="#thermodynamics" title="Permalink to this heading">#</a></h4>
<p>A corresponding thermodynamic equation is</p>
<div class="math notranslate nohighlight">
\[ \frac{D[b]}{Dt} + N^2 [w] = 0 \]</div>
<p>where we are assuming a fixed mean stratification <span class="math notranslate nohighlight">\(N^2\)</span> – as we do in the quasigeostrophic approximation.</p>
<p>Expanding the same way as we did above with the momentum equation, we can write</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [b]}{\partial t} &amp;= -N^2 [w] -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ( [v^* b^*] \cos\phi ) \\
&amp;= -N^2 [w] - J_b
\end{align*}\]</div>
<p>defining an eddy heat flux source term <span class="math notranslate nohighlight">\(J_b\)</span></p>
</section>
</section>
<section id="derivation-of-a-balanced-overturning-circulation">
<h3>Derivation of a balanced overturning circulation<a class="headerlink" href="#derivation-of-a-balanced-overturning-circulation" title="Permalink to this heading">#</a></h3>
<section id="thermal-wind">
<h4>Thermal wind<a class="headerlink" href="#thermal-wind" title="Permalink to this heading">#</a></h4>
<p>We can use geostrophic balance</p>
<div class="math notranslate nohighlight">
\[ f[u] = -\frac{1}{a} \frac{\partial [\Phi]}{\partial \phi} \]</div>
<p>and hydrostatic balance</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [\Phi]}{\partial z} = [b] \]</div>
<p>to define a thermal wind relation</p>
<div class="math notranslate nohighlight">
\[ f \frac{\partial [u]}{\partial z} = -\frac{1}{a} \frac{\partial [b]}{\partial \phi} \]</div>
<p>Now take time derivatives of both sides of the thermal wind equation, and substitute in from our momentum and thermodynamic equations to get</p>
<div class="math notranslate nohighlight">
\[ f^2 \frac{\partial [v]}{\partial z} - \frac{N^2}{a} \frac{\partial [w]}{\partial \phi} = f \frac{\partial J_u}{\partial z} + \frac{1}{a} \frac{\partial J_b}{\partial \phi}\]</div>
</section>
<section id="define-the-overturning-streamfunction">
<h4>Define the overturning streamfunction<a class="headerlink" href="#define-the-overturning-streamfunction" title="Permalink to this heading">#</a></h4>
<p>Define <span class="math notranslate nohighlight">\(\psi\)</span> so that a positive value is clockwise in the <span class="math notranslate nohighlight">\((\phi, z)\)</span> plane:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
[v] &amp;= -\frac{1}{a\cos\phi} \frac{\partial \psi}{\partial z} &amp; [w] &amp;= +\frac{1}{a^2 \cos\phi} \frac{\partial \psi}{\partial \phi}
\end{align*}\]</div>
<p>Then we have an equation for <span class="math notranslate nohighlight">\(\psi\)</span> from our thermal wind relation that looks like</p>
<div class="math notranslate nohighlight">
\[ -\frac{f^2}{a\cos\phi} \frac{\partial^2 \psi}{\partial z^2} - \frac{N^2}{a^3 \cos\phi} \frac{\partial^2 \psi}{\partial \phi^2} = f \frac{\partial J_u}{\partial z} + \frac{1}{a} \frac{\partial J_b}{\partial \phi}\]</div>
<p>This is a 2nd order PDE for <span class="math notranslate nohighlight">\(\psi\)</span> that’s potentially solvable, subject to boundary conditions and known eddy forcings <span class="math notranslate nohighlight">\(J_u, J_b\)</span>.</p>
<p>In fact the LHS of equation is essentially <span class="math notranslate nohighlight">\(-\nabla^2 \psi\)</span>, from which we can infer that the LHS is proportional to <span class="math notranslate nohighlight">\(\psi\)</span> itself.</p>
<p>So the equation has the form</p>
<div class="math notranslate nohighlight">
\[\psi \propto f \frac{\partial J_u}{\partial z} + \frac{1}{a} \frac{\partial J_b}{\partial \phi}\]</div>
<p>This tells us two things:</p>
<ol class="arabic simple">
<li><p>an increased vertical gradient of eddy momentum flux divergence wil act to increase <span class="math notranslate nohighlight">\(\psi\)</span></p></li>
<li><p>an increased horizontal gradient of eddy heat flux divergence will also act to increase <span class="math notranslate nohighlight">\(\psi\)</span></p></li>
</ol>
<p>When we looked at the observed fluxes in the winter hemisphere, we found that both forcing terms are positive.</p>
<p>We conclude that during winter, the eddies are driving a stronger Hadley cell.</p>
</section>
</section>
</section>
<section id="summary-of-hadley-cell-results">
<h2>Summary of Hadley Cell results<a class="headerlink" href="#summary-of-hadley-cell-results" title="Permalink to this heading">#</a></h2>
<p>We have two entirely different models of the zonally-averaged overturning circulation:</p>
<section id="the-angular-momentum-conserving-model">
<h3>The angular-momentum-conserving model<a class="headerlink" href="#the-angular-momentum-conserving-model" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(&lt;\theta&gt;\)</span> is determined by <span class="math notranslate nohighlight">\(M\)</span> conservation only</p></li>
<li><p><span class="math notranslate nohighlight">\(M\)</span> is constant on the poleward branch</p></li>
<li><p>Strength of the Hadley circulation is a function of <span class="math notranslate nohighlight">\(R_{OT}\)</span></p></li>
</ul>
<p>The basic ideas are summarized in this sketch:</p>
<figure class="align-default" id="id15">
<a class="reference internal image-reference" href="../_images/Vallis_fig14.4.pdf"><img alt="A simple model of the Hadley Cell" src="../_images/Vallis_fig14.4.pdf" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.4 </span><span class="caption-text">Source: <span id="id14">Vallis [<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">2017</a>]</span> (Figure 14.4 of the 2nd edition).</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="the-eddy-driven-model">
<h3>The eddy-driven model<a class="headerlink" href="#the-eddy-driven-model" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(&lt;\theta&gt;\)</span> is modified by eddy heat fluxes</p></li>
<li><p><span class="math notranslate nohighlight">\(M\)</span> decreases in the region of eddy momentum flux divergence</p></li>
<li><p>Strength of the Hadley circulation is controlled by the eddies themselves</p></li>
</ul>
<figure class="align-default" id="id17">
<a class="reference internal image-reference" href="../_images/Vallis_fig14.13.pdf"><img alt="Sketch of the eddy-driven Hadley Cell" src="../_images/Vallis_fig14.13.pdf" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.5 </span><span class="caption-text">Source: <span id="id16">Vallis [<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">2017</a>]</span> (Figure 14.13 of the 2nd edition). Sketch of how eddy fluxes can affect the Hadley Cell even when the baroclinic zone is centered well poleward of the Cell.</span><a class="headerlink" href="#id17" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In reality both sets of processes play a role. Reality is somewhere in between.</p>
</section>
</section>
<section id="the-mid-latitude-ferrel-cell">
<h2>The mid-latitude Ferrel cell<a class="headerlink" href="#the-mid-latitude-ferrel-cell" title="Permalink to this heading">#</a></h2>
<p>Let’s take one more look at the observed overturning during a solstice season:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">CSpsi</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                       <span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> 
                                       <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">levels</span><span class="o">=</span><span class="n">psi_levels</span><span class="p">,</span>
                                       <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                                            <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CSpsi</span><span class="p">,</span> <span class="n">CSpsi</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mass overturning streamfunction for January (Sv)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Mass overturning streamfunction for January (Sv)&#39;)
</pre></div>
</div>
<img alt="../_images/ab9ac1e5d494516458cc125e5d25a9a203d329401eb9c39572f86b2242c5a201.png" src="../_images/ab9ac1e5d494516458cc125e5d25a9a203d329401eb9c39572f86b2242c5a201.png" />
</div>
</div>
<p>The observed streamfunction shows a <em>thermally indirect</em> cell in mid-latitudes in both hemispheres; that is, cool air rises in the sub-polar latitudes, moves equatorward, and sinks in the subtropics.</p>
<p><em>Why does such a circulation exist?</em></p>
<section id="basic-argument-for-equatorward-flow-in-the-upper-branch">
<h3>Basic argument for equatorward flow in the upper branch<a class="headerlink" href="#basic-argument-for-equatorward-flow-in-the-upper-branch" title="Permalink to this heading">#</a></h3>
<p>The proximate answer to the “why” question is actually very simple so long as we take the eddy fluxes as given.</p>
<p>Consider the zonally averaged momentum equation we wrote down above:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [u]}{\partial t} &amp;= f[v] -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ([u^*v^*] \cos\phi) \\
&amp;= f[v] - J_u 
\end{align*}\]</div>
<p>If the circulation is in <em>steady state</em> then we must have a balance</p>
<div class="math notranslate nohighlight">
\[ f[v] = J_u \]</div>
<p>In other words, the Coriolis force on the mean meridonal flow balances the eddy momentum flux divergence.</p>
<p>Our plot above of the eddy momentum flux <span class="math notranslate nohighlight">\([u^*v^*] \cos\phi\)</span> showed that is decreases poleward of the subtropical maximum. So the momentum flux is <em>convergent</em> in the mid-latitudes – the eddies are extracting westerly momentum from the subtropics and exporting it to the mid-latitudes.</p>
<p>Thus <span class="math notranslate nohighlight">\(J_u = \frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ([u^*v^*] \cos\phi) &lt; 0\)</span> in the mid-latitudes, and so we must have <span class="math notranslate nohighlight">\([v]&lt;0\)</span> (equatorward) in order to produce the necessary westward zonal-mean Coriolis force.</p>
</section>
<section id="the-role-of-surface-friction">
<h3>The role of surface friction<a class="headerlink" href="#the-role-of-surface-friction" title="Permalink to this heading">#</a></h3>
<p>Mass conservation dictates that the flow cannot be equatorward at all levels. Also the observed momentum fluxes are much smaller near the surface.</p>
<p>Clearly a different force balance must be at work near the surface that constrains the poleward branch of the Ferrel cell.</p>
<p>The answer is, of course, friction.</p>
<p>Recall that surface friction typically affects the atmosphere through a turbulent boundary layer known as an <strong>Ekman layer</strong>. The dominant near-surface wind in the mid-latitudes is zonal and westerly, i.e. <span class="math notranslate nohighlight">\([u_s]&gt;0\)</span> (where the subscript <span class="math notranslate nohighlight">\(s\)</span> is for “surface”. This results in an Ekman transport at 90º to the surface frictional stress. The surface friction effectively “pushes” air poleward so that <span class="math notranslate nohighlight">\([v_s] &gt; 0\)</span>.</p>
<p>This situation is sketch in Vallis’s Figure 14.17:</p>
<figure class="align-default" id="id19">
<a class="reference internal image-reference" href="../_images/Vallis_fig14.17.pdf"><img alt="The eddy-driven Ferrel Cell, from an Eulerian point of view" src="../_images/Vallis_fig14.17.pdf" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8.6 </span><span class="caption-text">Source: <span id="id18">Vallis [<a class="reference internal" href="../info/references.html#id9" title="Geoffrey K. Vallis. Atmospheric and Oceanic Fluid Dynamics: fundamentals and large-scale circulation. Cambridge University Press, Cambridge, U.K., 2nd edition, 2017.">2017</a>]</span> (Figure 14.17 of the 2nd edition).</span><a class="headerlink" href="#id19" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="final-word">
<h3>Final word<a class="headerlink" href="#final-word" title="Permalink to this heading">#</a></h3>
<p>Hopefully this discussion makes clear that the eddy fluxes of heat and momentum play a major role in the mid-latitude circulation.</p>
<p>What we’ve offered here is a <em>description</em> of the zonal-mean balances, given the observed eddy fluxes. A complete theory of the general circulation needs to explain why those eddy fluxes exist and why they have the shape and size that we observe.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "aug22"
        },
        kernelOptions: {
            name: "aug22",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'aug22'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ape.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Available Potential Energy</p>
      </div>
    </a>
    <a class="right-next"
       href="tem.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">9. </span>Effect of eddies on the zonal mean circulation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-governing-equations">Assumptions and governing equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#governing-equations">Governing equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-radiative-convective-equilibrium-temperature-profile">The radiative-convective equilibrium temperature profile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions">Boundary conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frictional-solution-pure-radiative-convective-equilibrium">Frictional solution: pure radiative-convective equilibrium</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-the-zonal-wind-profile">Solving for the zonal wind profile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#profile-of-absolute-angular-momentum">Profile of absolute angular momentum</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extensions-of-the-zonally-symmetric-theory">Extensions of the zonally symmetric theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effects-of-moisture">Effects of moisture</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effects-of-seasonality">Effects of seasonality</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#does-the-upper-branch-actually-conserve-angular-momentum">Does the upper branch actually conserve angular momentum?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-overturning-streamfunction">Calculate the overturning streamfunction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-absolute-angular-momentum">Calculate the absolute angular momentum</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-plot-of-the-overturning-circulation-overlain-on-the-angular-momentum-contours">Make a plot of the overturning circulation overlain on the angular momentum contours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effects-of-eddies-on-the-hadley-cell-qualitative-and-diagnostic-arguments">Effects of eddies on the Hadley cell: qualitative and diagnostic arguments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eddies-in-the-angular-momentum-budget">Eddies in the angular momentum budget</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-observed-eddy-momentum-flux">The observed eddy momentum flux</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-effects-of-eddies">Thermodynamic effects of eddies</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-idealized-eddy-driven-hadley-cell-model">An idealized eddy-driven Hadley cell model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zonally-averaged-boussinesq-equations">Zonally averaged Boussinesq equations</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#momentum">Momentum</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamics">Thermodynamics</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-a-balanced-overturning-circulation">Derivation of a balanced overturning circulation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-wind">Thermal wind</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-overturning-streamfunction">Define the overturning streamfunction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-hadley-cell-results">Summary of Hadley Cell results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-angular-momentum-conserving-model">The angular-momentum-conserving model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-eddy-driven-model">The eddy-driven model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-mid-latitude-ferrel-cell">The mid-latitude Ferrel cell</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-argument-for-equatorward-flow-in-the-upper-branch">Basic argument for equatorward flow in the upper branch</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-role-of-surface-friction">The role of surface friction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-word">Final word</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brian E. J. Rose
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>