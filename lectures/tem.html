
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>9. Effect of eddies on the zonal mean circulation &#8212; ATM 622: General Circulation of the Atmosphere</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. Top-of-Atmosphere Radiation Budget and Meridional Energy Transport" href="../assignments/assignment-toa-budget.html" />
    <link rel="prev" title="8. Theories of the Hadley circulation" href="hadley.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ATM 622: General Circulation of the Atmosphere</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../home.html">
                    ATM 622: General Circulation of the Atmosphere
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course info
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../info/syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../info/schedule.html">
   Schedule
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../info/how-to.html">
   How to use this book
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="radiation-budget.html">
   1. Earth’s radiation budget
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="computing-seasonal.html">
   2. Computing seasonal and monthly means from CFSR data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="observed-circulation.html">
   3. The observed circulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="decomposing-circulation.html">
   4. Decompositions of the circulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="angular-momentum-budget.html">
   5. Angular Momentum Budget
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="energy-budget.html">
   6. Energy Budget
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ape.html">
   7. Available Potential Energy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hadley.html">
   8. Theories of the Hadley circulation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   9. Effect of eddies on the zonal mean circulation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments and labs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/assignment-toa-budget.html">
   1. Top-of-Atmosphere Radiation Budget and Meridional Energy Transport
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The stuff at the end
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../info/dask_test.html">
   Benchmarking a data-intensive operation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../info/dask_test_snow.html">
   Benchmarking a data-intensive operation (snow version)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../info/references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/brian-rose/general-circulation/main?urlpath=lab/tree/./lectures/tem.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://lore.atmos.albany.edu:8000/hub/user-redirect/git-pull?repo=https%3A//github.com/brian-rose/general-circulation&urlpath=lab/tree/general-circulation/./lectures/tem.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/brian-rose/general-circulation"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/brian-rose/general-circulation/issues/new?title=Issue%20on%20page%20%2Flectures/tem.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/lectures/tem.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-transformed-eulerian-mean-tem-or-residual-circulation">
   The Transformed Eulerian Mean (TEM) or “Residual Circulation”
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-residual-overturning-required-by-diabatic-heating">
     The residual overturning required by diabatic heating
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acceleration-of-the-zonal-mean-wind">
     Acceleration of the zonal mean wind
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-eliassen-palm-flux-vector">
     The Eliassen-Palm flux vector
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-potential-vorticity-perspective">
   A potential vorticity perspective
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-idea">
     The idea
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zonal-average-qgpv-equation">
     Zonal average QGPV equation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-perspective-on-the-steady-balanced-circulation">
     A perspective on the steady, balanced circulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tem-equations-for-the-atmosphere">
   TEM equations for the atmosphere
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-ep-flux-vector-components-for-the-atmosphere">
     The EP flux vector components for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#complete-set-of-tem-equations-for-the-atmosphere">
     Complete set of TEM equations for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-residual-mean-for-the-atmosphere">
     The residual mean for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#an-angular-momentum-equation">
     An angular momentum equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-eliassen-palm-cross-section-from-reanalysis-data">
   Plotting the Eliassen-Palm cross-section from reanalysis data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-classic-figure">
     The classic figure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-cfsr-data-and-get-to-work">
     Load the CFSR data and get to work
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heat-flux">
     Heat flux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#momentum-flux">
     Momentum flux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stratification">
     Stratification
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-rescaled-hat-components">
     The rescaled “hat” components
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-ep-flux-diagram">
     Plotting the EP flux diagram
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpreting-the-ep-flux-diagram">
     Interpreting the EP flux diagram
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-residual-overturning-from-reanalysis-data">
   The residual overturning from reanalysis data
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Effect of eddies on the zonal mean circulation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-transformed-eulerian-mean-tem-or-residual-circulation">
   The Transformed Eulerian Mean (TEM) or “Residual Circulation”
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-residual-overturning-required-by-diabatic-heating">
     The residual overturning required by diabatic heating
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acceleration-of-the-zonal-mean-wind">
     Acceleration of the zonal mean wind
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-eliassen-palm-flux-vector">
     The Eliassen-Palm flux vector
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-potential-vorticity-perspective">
   A potential vorticity perspective
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-idea">
     The idea
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zonal-average-qgpv-equation">
     Zonal average QGPV equation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-perspective-on-the-steady-balanced-circulation">
     A perspective on the steady, balanced circulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tem-equations-for-the-atmosphere">
   TEM equations for the atmosphere
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-ep-flux-vector-components-for-the-atmosphere">
     The EP flux vector components for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#complete-set-of-tem-equations-for-the-atmosphere">
     Complete set of TEM equations for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-residual-mean-for-the-atmosphere">
     The residual mean for the atmosphere
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#an-angular-momentum-equation">
     An angular momentum equation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-eliassen-palm-cross-section-from-reanalysis-data">
   Plotting the Eliassen-Palm cross-section from reanalysis data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-classic-figure">
     The classic figure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-the-cfsr-data-and-get-to-work">
     Load the CFSR data and get to work
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heat-flux">
     Heat flux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#momentum-flux">
     Momentum flux
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stratification">
     Stratification
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-rescaled-hat-components">
     The rescaled “hat” components
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-the-ep-flux-diagram">
     Plotting the EP flux diagram
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpreting-the-ep-flux-diagram">
     Interpreting the EP flux diagram
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-residual-overturning-from-reanalysis-data">
   The residual overturning from reanalysis data
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="effect-of-eddies-on-the-zonal-mean-circulation">
<h1><span class="section-number">9. </span>Effect of eddies on the zonal mean circulation<a class="headerlink" href="#effect-of-eddies-on-the-zonal-mean-circulation" title="Permalink to this headline">#</a></h1>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">#</a></h2>
<p>We saw at the <a class="reference external" href="https://brian-rose.github.io/general-circulation/lectures/hadley.html#effects-of-eddies-on-the-hadley-cell-qualitative-and-diagnostic-arguments">end of the last set of notes</a> that both eddy momentum fluxes and eddy heat (buoyancy) fluxes are both involved in determing the zonal-mean flow:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [u]}{\partial t} &amp;= f[v] -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ([u^*v^*] \cos\phi) \\
\frac{\partial [b]}{\partial t} &amp;= -N^2 [w] -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ( [v^* b^*] \cos\phi ) + \dot{Q} 
\end{align*}\]</div>
<p>Let’s consider the effects of an eddy heat flux on a frictionless, adiabatic system (<span class="math notranslate nohighlight">\(\dot{Q} = 0\)</span>).</p>
<p>At steady state, the thermodynamic equation tells us that we must have an Eulerian mean overturning circulation with vertical component</p>
<div class="math notranslate nohighlight">
\[ [w] = -\frac{1}{a\cos\phi N^2} \frac{\partial}{\partial \phi} ( [v^* b^*] \cos\phi ) \]</div>
<p>which in turn, by mass conservation, requires a horizontal component of the overturning <span class="math notranslate nohighlight">\([v]\)</span>.</p>
<p>But <span class="math notranslate nohighlight">\([v]\)</span> enters into the momentum equation through the Coriolis force.</p>
<p>So, <em>eddy heat fluxes must <strong>accelerate</strong> the zonal mean zonal wind <span class="math notranslate nohighlight">\([u]\)</span> through Coriolis forces associated with the overturning circulation</em>. Eddy heat fluxes appear in the zonal mean momentum equation disguised as Coriolis force.</p>
<p>Are you confused yet?</p>
<p>Maybe there’s a better way to express the <strong>combined effect of eddy heat and momentum fluxes</strong> that clarify under what conditions the eddies can accelerate the mean zonal flow <span class="math notranslate nohighlight">\([u]\)</span>.</p>
<p>[Related, we’ve also seen that the <a class="reference external" href="https://brian-rose.github.io/general-circulation/lectures/ape.html#diagram-of-the-lorenz-energy-cycle">Lorenz cycle</a> reveals substantial conversion from eddy kinetic energy to kinetic energy of the mean flow]</p>
<p>Along the way, we may also find a better way to think about the overturning circulation in a flow dominated by eddies.</p>
</section>
<section id="the-transformed-eulerian-mean-tem-or-residual-circulation">
<h2>The Transformed Eulerian Mean (TEM) or “Residual Circulation”<a class="headerlink" href="#the-transformed-eulerian-mean-tem-or-residual-circulation" title="Permalink to this headline">#</a></h2>
<section id="the-residual-overturning-required-by-diabatic-heating">
<h3>The residual overturning required by diabatic heating<a class="headerlink" href="#the-residual-overturning-required-by-diabatic-heating" title="Permalink to this headline">#</a></h3>
<p>Define a “residual” vertical motion <span class="math notranslate nohighlight">\(w_{res}\)</span> as the direct response to diabatic heating, accounting for the large cancellation between eddy heat flux convergence and adiabatic ascent:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [b]}{\partial t} = -N^2 w_{res} + \dot{Q} \]</div>
<p>where we have just wrapped the eddy heat flux term into <span class="math notranslate nohighlight">\(w_{res}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ w_{res} = [w] + \frac{1}{a\cos\phi N^2} \frac{\partial}{\partial \phi} ( [v^* b^*] \cos\phi ) \]</div>
<p>So far, just clever notation.</p>
<p>Now, let’s define the horizonal component of the residual overturning <span class="math notranslate nohighlight">\(v_{res}\)</span> to obey mass continuity:</p>
<div class="math notranslate nohighlight">
\[ \frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} \left( v_{res} \cos\phi \right) + \frac{\partial}{\partial z} w_{res} = 0 \]</div>
<p>So between <span class="math notranslate nohighlight">\(v_{res}\)</span> and the Eulerian mean <span class="math notranslate nohighlight">\([v]\)</span> must be</p>
<div class="math notranslate nohighlight">
\[ v_{res} = [v] - \frac{\partial}{\partial z} \left( \frac{[v^* b^*]}{N^2}  \right)\]</div>
<p>Together <span class="math notranslate nohighlight">\(v_{res}, w_{res}\)</span> describe a residual overturning circulation specifically required by the diabatic heating!</p>
</section>
<section id="acceleration-of-the-zonal-mean-wind">
<h3>Acceleration of the zonal mean wind<a class="headerlink" href="#acceleration-of-the-zonal-mean-wind" title="Permalink to this headline">#</a></h3>
<p>Now let’s use this to rewrite the momentum equation in terms of the Coriolis force due to <span class="math notranslate nohighlight">\(v_{res}\)</span>:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [u]}{\partial t} &amp;= f[v] -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ([u^*v^*] \cos\phi) \\
&amp;= f\left( v_{res} +  \frac{\partial}{\partial z} \left( \frac{[v^* b^*]}{N^2}  \right) \right) -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ([u^*v^*] \cos\phi)
\end{align*}\]</div>
<p>or, rewriting with only eddy forcing terms on the RHS:</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [u]}{\partial t} - f v_{res} = -\frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} ([u^*v^*] \cos\phi) + f \frac{\partial}{\partial z} \left( \frac{[v^* b^*]}{N^2}  \right) \]</div>
<p>This is actually a deep result. <span class="math notranslate nohighlight">\(v_{res}\)</span> is determined entirely by the zonal diabatic heating, regardless of what the eddies are doing. Our transformed momentum equation tells that there’s a very specific combination of eddy heat and momemtum fluxes that accelerate the zonal mean wind.</p>
<p>The transformed equation no longer has any “hidden” eddy effects – it expresses more completely how the eddies drive the mean flow.</p>
</section>
<section id="the-eliassen-palm-flux-vector">
<h3>The Eliassen-Palm flux vector<a class="headerlink" href="#the-eliassen-palm-flux-vector" title="Permalink to this headline">#</a></h3>
<p>It’s useful and traditional to define a vector <span class="math notranslate nohighlight">\(\vec{F}\)</span> (in the latitude-height plane) whose divergence appears on the RHS of the momentum equation. That is, we want to write the Transformed Eulerian Mean system like this:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [u]}{\partial t} - f v_{res} &amp;= \nabla \cdot \vec{F} \\
\frac{\partial [b]}{\partial t} &amp;= -N^2 w_{res} + \dot{Q} 
\end{align*}\]</div>
<p>From the transformed momentum equation above, we can see that</p>
<ul class="simple">
<li><p>the vertical component of <span class="math notranslate nohighlight">\(\vec{F}\)</span> must be propotional to eddy heat flux</p></li>
<li><p>the horizontal component of <span class="math notranslate nohighlight">\(\vec{F}\)</span> must be proportional to eddy momentum flux (but in reverse direction)</p></li>
</ul>
<p>More precisely, we can define <span class="math notranslate nohighlight">\(\vec{F}\)</span> for this system like this:</p>
<div class="math notranslate nohighlight">
\[ \vec{F} = -[u^* v^*] \hat{j} + \frac{f}{N^2} [v^* b^*] \hat{k} \]</div>
<p>The vector <span class="math notranslate nohighlight">\(\vec{F}\)</span> is called the Eliassen-Palm flux, after a pioneering paper by <span id="id1">Eliassen and Palm [<a class="reference internal" href="../info/references.html#id17" title="Arnt Eliassen and Enok Palm. On the transfer of energy in stationary mountain waves. Geofysiske Publikasjoner, 22(3):1–23, 1961.">1961</a>]</span>.</p>
</section>
</section>
<section id="a-potential-vorticity-perspective">
<h2>A potential vorticity perspective<a class="headerlink" href="#a-potential-vorticity-perspective" title="Permalink to this headline">#</a></h2>
<section id="the-idea">
<h3>The idea<a class="headerlink" href="#the-idea" title="Permalink to this headline">#</a></h3>
<p>We’ve been talking about combining momentum and thermodynamic constraints together into a single quantity <span class="math notranslate nohighlight">\(\vec{F}\)</span>. That may sound familiar.</p>
<p>Recall that under the Quasi-Geostrophic approximation, we boil down all the dynamics into a single prognostic scalar, the quasi-geostrophic potential vorticity (QGPV).  We might therefore expect a deep relationship between PV dynamics and the Eliassen-Palm flux <span class="math notranslate nohighlight">\(\vec{F}\)</span>.</p>
<p>And there is!</p>
</section>
<section id="zonal-average-qgpv-equation">
<h3>Zonal average QGPV equation<a class="headerlink" href="#zonal-average-qgpv-equation" title="Permalink to this headline">#</a></h3>
<p>Let’s write</p>
<p>[Need to fill in details here]</p>
<p>The key result</p>
<div class="math notranslate nohighlight">
\[[v^*q^*] = \nabla \cdot \vec{F} \]</div>
<p>The divergence of the EP flux (which is a specific combination of eddy heat and momentum fluxes) is equivalent to a northward eddy flux of QGPV!</p>
<p>So another form of the TEM equations is (under the quasi-geostrophic approximation):</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [u]}{\partial t} - f v_{res} &amp;= [v^* q^*] \\
\frac{\partial [b]}{\partial t} &amp;= -N^2 w_{res} + \dot{Q} 
\end{align*}\]</div>
</section>
<section id="a-perspective-on-the-steady-balanced-circulation">
<h3>A perspective on the steady, balanced circulation<a class="headerlink" href="#a-perspective-on-the-steady-balanced-circulation" title="Permalink to this headline">#</a></h3>
<p>For a balanced time-mean flow, our TEM equations thus say</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
 - f v_{res} &amp;= [v^* q^*] \\
N^2 w_{res} &amp;=  \dot{Q} 
\end{align*}\]</div>
<p>Now consider the fact that the diabatic heating tends to decrease from equator to pole. So <span class="math notranslate nohighlight">\(w_[res]\)</span> might be upward near the equator and downward near the pole.</p>
<p>We infer from this that <span class="math notranslate nohighlight">\(v_{res}\)</span> must be poleward aloft (to conserve mass) – i.e. <span class="math notranslate nohighlight">\(v_{res} &gt; 0\)</span>. The residual circulation should look something like a big equator-to-pole scale Hadley cell!</p>
<p>But this poleward residual circulation applies an <em>eastward</em> Coriolis force on the zonal wind. To have a steady balance, the eddies must be arranged to produce an equal and opposite <em>westward</em> force.</p>
<p>We can infer from this that the eddies must be fluxing QGPV <em>equatorward</em>, i.e. <span class="math notranslate nohighlight">\([v^* q^*] &lt; 0\)</span></p>
<p>Since the planetary PV increases toward the poles, the eddies are thus flux PV down the mean gradient. Unlike for momentum, the eddies behave diffusively in the PV framework – acting to transport PV from the high reservoir near the poles to the low reservoir near the equator.</p>
</section>
</section>
<section id="tem-equations-for-the-atmosphere">
<h2>TEM equations for the atmosphere<a class="headerlink" href="#tem-equations-for-the-atmosphere" title="Permalink to this headline">#</a></h2>
<p>The theory and diagnostic method are laid out in a well-known paper by <span id="id2">Edmon Jr. <em>et al.</em> [<a class="reference internal" href="../info/references.html#id16" title="H. J. Edmon Jr., B.J. Hoskins, and M.E. McIntyre. Eliassen-Palm cross sections for the troposphere. J. Atmos. Sci., 37:2600–2616, 1980. doi:10.1175/1520-0469(1980)037&lt;2600:EPCSFT&gt;2.0.CO;2.">1980</a>]</span>.</p>
<section id="the-ep-flux-vector-components-for-the-atmosphere">
<h3>The EP flux vector components for the atmosphere<a class="headerlink" href="#the-ep-flux-vector-components-for-the-atmosphere" title="Permalink to this headline">#</a></h3>
<p>The appropriate definitions for the components of <span class="math notranslate nohighlight">\(\vec{F}\)</span> are</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_\phi &amp;= -a \cos\phi [u^* v^*] \\
F_p &amp;= f a \cos\phi \frac{[v^* \theta^*]}{\sigma}
\end{align*}\]</div>
<p>where we now use pressure coordinates, measure buoyancy using potential temperature <span class="math notranslate nohighlight">\(\theta\)</span>, and we have defined a stratification parameter</p>
<div class="math notranslate nohighlight">
\[ \sigma \equiv \frac{\partial [\theta]}{\partial p} \]</div>
<p><em>Note that <span class="math notranslate nohighlight">\(\sigma&lt;0\)</span> for statically stable conditions since <span class="math notranslate nohighlight">\(\theta\)</span> increases upward.</em></p>
</section>
<section id="complete-set-of-tem-equations-for-the-atmosphere">
<h3>Complete set of TEM equations for the atmosphere<a class="headerlink" href="#complete-set-of-tem-equations-for-the-atmosphere" title="Permalink to this headline">#</a></h3>
<p>TEM equations for the atmosphere on a sphere look like</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{\partial [u]}{\partial t} - f v_{res} &amp;= \frac{1}{a \cos\phi} \nabla \cdot \vec{F} \\
f \frac{\partial [u]}{p} - \frac{R}{a} \frac{\partial [\theta]}{\partial \phi} &amp;= 0\\
\frac{\partial [\theta]}{\partial t} + \sigma \omega_{res} &amp;= \dot{Q} \\
\frac{1}{a \cos\phi} \frac{\partial}{\partial \phi} \left( v_{res} \cos\phi \right) + \frac{\partial \omega_{res}}{\partial p} &amp;= 0 
\end{align*}\]</div>
</section>
<section id="the-residual-mean-for-the-atmosphere">
<h3>The residual mean for the atmosphere<a class="headerlink" href="#the-residual-mean-for-the-atmosphere" title="Permalink to this headline">#</a></h3>
<p>Definitions for <span class="math notranslate nohighlight">\(v_{res}\)</span> and <span class="math notranslate nohighlight">\(\omega_{res}\)</span> consistent with the above equations are</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
v_{res} &amp;= [v] - \frac{\partial}{\partial p} \left( \frac{ [v^*\theta^*]}{\sigma} \right) \\
\omega_{res} &amp;= [\omega] _ \frac{1}{a\cos\phi} \frac{\partial}{\partial \phi} \left( \frac{[v^* \theta^*] \cos\phi}{\sigma} \right) 
\end{align*}\]</div>
</section>
<section id="an-angular-momentum-equation">
<h3>An angular momentum equation<a class="headerlink" href="#an-angular-momentum-equation" title="Permalink to this headline">#</a></h3>
<p>The Eulerian mean angular momentum <span class="math notranslate nohighlight">\([M]\)</span> is</p>
<div class="math notranslate nohighlight">
\[[M] = \Omega a^2 \cos^2\phi + [u] a \cos\phi\]</div>
<p>so the transformed zonal momentum equation can also be expressed in terms of angular momentum as</p>
<div class="math notranslate nohighlight">
\[ \frac{\partial [M]}{\partial t} + \frac{v_{res}}{a} \frac{\partial M}{\partial \phi} = \nabla \cdot \vec{F} \]</div>
<p>to quasi-geostrophic order.</p>
<p>This form shows that the divergence of the EP flux is a direct eddy forcing on the zonal mean angular momentum – a torque on the atmosphere!</p>
</section>
</section>
<section id="plotting-the-eliassen-palm-cross-section-from-reanalysis-data">
<h2>Plotting the Eliassen-Palm cross-section from reanalysis data<a class="headerlink" href="#plotting-the-eliassen-palm-cross-section-from-reanalysis-data" title="Permalink to this headline">#</a></h2>
<section id="the-classic-figure">
<h3>The classic figure<a class="headerlink" href="#the-classic-figure" title="Permalink to this headline">#</a></h3>
<p>We are going to make an updated version of this famous figure showing <span class="math notranslate nohighlight">\(\vec{F}\)</span> and its divergence:</p>
<figure class="align-default" id="markdown-fig">
<a class="reference internal image-reference" href="../_images/Edmon_Fig5.pdf"><img alt="Eliassen-Palm cross-section" src="../_images/Edmon_Fig5.pdf" style="width: 800px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9.1 </span><span class="caption-text">Source: <span id="id3">Edmon Jr. <em>et al.</em> [<a class="reference internal" href="../info/references.html#id16" title="H. J. Edmon Jr., B.J. Hoskins, and M.E. McIntyre. Eliassen-Palm cross sections for the troposphere. J. Atmos. Sci., 37:2600–2616, 1980. doi:10.1175/1520-0469(1980)037&lt;2600:EPCSFT&gt;2.0.CO;2.">1980</a>]</span> (Their Figure 5).</span><a class="headerlink" href="#markdown-fig" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="load-the-cfsr-data-and-get-to-work">
<h3>Load the CFSR data and get to work<a class="headerlink" href="#load-the-cfsr-data-and-get-to-work" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask_jobqueue</span> <span class="kn">import</span> <span class="n">SLURMCluster</span>
<span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">SLURMCluster</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>  <span class="c1">#By default Dask will run one Python process per job. </span>
                       <span class="c1"># However, you can optionally choose to cut up that job into multiple processes</span>
                       <span class="n">cores</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="c1"># size of a single job -- typically one node of the HPC cluster</span>
                       <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;376.2GB&quot;</span><span class="p">,</span>  <span class="c1"># the max memory on the 80-core batch nodes, I believe</span>
                       <span class="n">walltime</span><span class="o">=</span><span class="s2">&quot;04:00:00&quot;</span><span class="p">,</span>
                       <span class="n">queue</span><span class="o">=</span><span class="s2">&quot;batch&quot;</span><span class="p">,</span>
                      <span class="p">)</span>
<span class="n">cluster</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">2018</span><span class="p">)</span>  <span class="c1"># Ten years of data 2008 through 2017</span>
<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="n">path_to_cfsr_data</span> <span class="o">=</span> <span class="s1">&#39;/network/daes/cfsr/data/&#39;</span>
<span class="n">ending</span> <span class="o">=</span> <span class="s1">&#39;.0p5.anl.nc&#39;</span>

<span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">path_to_cfsr_data</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">var</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="n">ending</span>
        <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfsr_6hourly</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;lev&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">})</span>
<span class="n">cfsr_6hourly</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">v</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">u</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<p>Convert temperature to potential temperature:</p>
<div class="math notranslate nohighlight">
\[\theta = T \left(\frac{p_{ref}}{p}\right)^\kappa \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\kappa = \frac{R}{c_p} = 0.286\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">climlab.utils.constants</span> <span class="kn">import</span> <span class="n">Rd</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">g</span>

<span class="n">sidereal_period</span> <span class="o">=</span> <span class="p">(</span><span class="mi">23</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mi">56</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="mf">4.09053</span>  <span class="c1"># Earth&#39;s rotational period in seconds -- just shy of one day</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">sidereal_period</span>  <span class="c1"># Earth&#39;s angular rotation rate (radians / second)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">lev</span> <span class="o">*</span> <span class="mf">100.</span>  <span class="c1"># in units of Pa</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>  <span class="c1"># in units of radians</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>

<span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">Omega</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>  <span class="c1"># everyone&#39;s favorite Coriolis parameter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pref</span> <span class="o">=</span> <span class="mf">1000.</span>  <span class="c1"># reference pressure in hPa</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="n">Rd</span><span class="o">/</span><span class="n">cp</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">T</span> <span class="o">*</span> <span class="p">(</span><span class="n">pref</span><span class="o">/</span><span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">lev</span><span class="p">)</span><span class="o">**</span><span class="n">kappa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bracket</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">star</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span> <span class="o">-</span> <span class="n">bracket</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">prime</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">cfsr_6hourly</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">-</span> <span class="n">bar</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="heat-flux">
<h3>Heat flux<a class="headerlink" href="#heat-flux" title="Permalink to this headline">#</a></h3>
<p>Compute the heat flux term</p>
<div class="math notranslate nohighlight">
\[\overline{[v^* \theta^*]}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heatflux</span> <span class="o">=</span> <span class="n">bar</span><span class="p">(</span><span class="n">bracket</span><span class="p">(</span><span class="n">star</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">star</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>Compute for solstice seasons:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heatflux_computed</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="n">heatflux_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">=</span> <span class="n">heatflux</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">thisflux</span> <span class="o">=</span> <span class="n">heatflux_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="n">thisflux</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                               <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                               <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                               <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eddy heat flux (K m/s), 2008-2017 </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="momentum-flux">
<h3>Momentum flux<a class="headerlink" href="#momentum-flux" title="Permalink to this headline">#</a></h3>
<p>Compute the momentum flux term</p>
<div class="math notranslate nohighlight">
\[ [u^* v^*] \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">momentumflux</span> <span class="o">=</span> <span class="n">bar</span><span class="p">(</span><span class="n">bracket</span><span class="p">(</span><span class="n">star</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">*</span> <span class="n">star</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">momentumflux_computed</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="n">momentumflux_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">=</span> <span class="n">momentumflux</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">thisflux</span> <span class="o">=</span> <span class="n">momentumflux_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="n">thisflux</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                               <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                               <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                               <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eddy momentum flux (m2/s2), 1988-2017 </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="stratification">
<h3>Stratification<a class="headerlink" href="#stratification" title="Permalink to this headline">#</a></h3>
<p>Compute the static stability term</p>
<div class="math notranslate nohighlight">
\[ \sigma = \frac{\partial [\overline{\theta}]}{\partial p} \]</div>
<p>in units of K Pa<span class="math notranslate nohighlight">\(^{-1}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta_zon</span> <span class="o">=</span> <span class="n">bar</span><span class="p">(</span><span class="n">bracket</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">theta_zon</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.</span>  <span class="c1"># convert from K / hPa to K / Pa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma_computed</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="n">sigma_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.0005</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">thissigma</span> <span class="o">=</span> <span class="n">sigma_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="n">thissigma</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                               <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                               <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                               <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Stratification parameter (K / Pa), 2008-2017 </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-rescaled-hat-components">
<h3>The rescaled “hat” components<a class="headerlink" href="#the-rescaled-hat-components" title="Permalink to this headline">#</a></h3>
<p>Define the quantity <span class="math notranslate nohighlight">\(\Delta\)</span> as</p>
<div class="math notranslate nohighlight">
\[ \Delta = \frac{\partial}{\partial \phi} \hat{F}_\phi + \frac{\partial}{\partial p} \hat{F}_p\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat{F}_\phi &amp;= \frac{2\pi a}{g} \cos\phi F_\phi \\
\hat{F}_p &amp;= \frac{2 \pi a^2}{g} \cos\phi F_p
\end{align*}\]</div>
<p>so that <span class="math notranslate nohighlight">\(\Delta d\phi dp\)</span> is the divergence of <span class="math notranslate nohighlight">\(\vec{F}\)</span> weighted by the mass of the annulus <span class="math notranslate nohighlight">\(d\phi dp\)</span>.</p>
</section>
<section id="plotting-the-ep-flux-diagram">
<h3>Plotting the EP flux diagram<a class="headerlink" href="#plotting-the-ep-flux-diagram" title="Permalink to this headline">#</a></h3>
<p>We will plot contours of <span class="math notranslate nohighlight">\(\Delta\)</span> to best represent the eddy forcing of the mean flow. <em>Note that <span class="math notranslate nohighlight">\(\Delta\)</span> has dimensions of length cubed.</em></p>
<p>Similarly, we will represent <span class="math notranslate nohighlight">\(\vec{F}\)</span> by plotting arrows whose horizontal and vertical components are respectively proportional to <span class="math notranslate nohighlight">\(\hat{F}_\phi\)</span> and <span class="math notranslate nohighlight">\(\hat{F}_p\)</span>. However we re-scale the vertical component by a factor related to the aspect ratio of the plot: vertical distance per Pa / horizontal distance per radian.</p>
<p>This allows for a more natural visual interpretation of the plot, since arrow lengths in the horizontal and vertical now correspond directly to their contribution to the divergence.</p>
<p>The resulting graph is precisely the Eliassen-Palm cross-section defined by Edmon et al.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_ep_flux</span><span class="p">(</span><span class="n">heatflux</span><span class="p">,</span> <span class="n">momentumflux</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;aspect is vertical distance per hPa / horizontal distance per degree (in figure units)&#39;&#39;&#39;</span>
    
    <span class="c1"># Calculate the physical div F (not the hat version that is used for plotting, see Edmon et al.)</span>
    <span class="n">F_phi</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">momentumflux</span>  <span class="c1"># in units of m^3/s^2</span>
    <span class="n">F_p</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">heatflux</span> <span class="o">/</span> <span class="n">sigma</span>  <span class="c1"># in units of Pa m^2/s^2   </span>
    <span class="c1"># The rescaled &quot;hat&quot; components</span>
    <span class="n">Fhat_phi</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">F_phi</span>  <span class="c1"># in units of m^3</span>
    <span class="n">Fhat_p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">F_p</span>   <span class="c1"># in units of Pa m^3</span>
    <span class="c1"># Compute divergence</span>
    <span class="n">Delta_phi</span> <span class="o">=</span> <span class="n">Fhat_phi</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">)</span>  <span class="c1"># In m^3 / degree</span>
    <span class="n">Delta_phi</span> <span class="o">*=</span> <span class="mf">180.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># Now in m^3 / radian = m^3</span>
    <span class="n">Delta_p</span> <span class="o">=</span> <span class="n">Fhat_p</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">)</span>  <span class="c1"># Now in Pa m^3 / hPa</span>
    <span class="n">Delta_p</span> <span class="o">/=</span> <span class="mf">100.</span>  <span class="c1"># In Pa m^3 / Pa = m^3</span>
    <span class="n">Delta</span> <span class="o">=</span> <span class="n">Delta_phi</span> <span class="o">+</span> <span class="n">Delta_p</span>  <span class="c1"># in units of m^3</span>
    
    <span class="n">aspect</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># vertical distance per hPa / horizontal distance per degree (in figure units)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">aspect</span> <span class="o">/</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>  <span class="c1"># vertical distance per Pa / horizontal distance per radian</span>

    <span class="c1"># multiply the F_p component by A so that the arrows are properly scaled.</span>
    <span class="c1"># The factor -1 is necessary to correct a sign issue with the quiver plot</span>
    <span class="c1"># Presumably because the pressure axis is increasing downward</span>
    <span class="n">Fhat_scaled</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s2">&quot;Fhat_phi&quot;</span><span class="p">:</span> <span class="n">Fhat_phi</span><span class="p">,</span> <span class="s2">&quot;Fhat_p&quot;</span><span class="p">:</span> <span class="n">Fhat_p</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
    
    <span class="c1"># If we plot the data as-is, there will be far too many arrows because of the high spatial resolution of the data.</span>
    <span class="c1"># We will down-sample in the latitude dimension before plotting the arrows.</span>
    <span class="n">coarseFhat</span> <span class="o">=</span> <span class="n">Fhat_scaled</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;pad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">Delta</span><span class="p">,</span> <span class="n">Delta_phi</span><span class="p">,</span> <span class="n">Delta_p</span><span class="p">,</span> <span class="n">coarseFhat</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Delta</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">Delta_phi</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">Delta_p</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">coarseFhat</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="n">Delta</span><span class="p">[</span><span class="n">season</span><span class="p">],</span> <span class="n">Delta_phi</span><span class="p">[</span><span class="n">season</span><span class="p">],</span> <span class="n">Delta_p</span><span class="p">[</span><span class="n">season</span><span class="p">],</span> <span class="n">coarseFhat</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">=</span> \
        <span class="n">compute_ep_flux</span><span class="p">(</span><span class="n">heatflux_computed</span><span class="p">[</span><span class="n">season</span><span class="p">],</span> 
                        <span class="n">momentumflux_computed</span><span class="p">[</span><span class="n">season</span><span class="p">],</span>
                        <span class="n">sigma_computed</span><span class="p">[</span><span class="n">season</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">epfluxplot</span><span class="p">(</span><span class="n">Delta</span><span class="p">,</span> <span class="n">Fhat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span>
             <span class="o">-</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
              <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>
             <span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="p">)</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="p">(</span><span class="n">Delta</span><span class="o">/</span><span class="mf">1E15</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                               <span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> 
                               <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                               <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                               <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">,</span>
                                   <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">CS</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">Fhat</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lev&quot;</span><span class="p">,</span> 
                     <span class="n">u</span><span class="o">=</span><span class="s2">&quot;Fhat_phi&quot;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="s2">&quot;Fhat_p&quot;</span><span class="p">,</span> 
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EP flux and divergence, 2008-2017 </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">epfluxplot</span><span class="p">(</span><span class="n">Delta</span><span class="p">[</span><span class="n">season</span><span class="p">],</span> <span class="n">coarseFhat</span><span class="p">[</span><span class="n">season</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">season</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpreting-the-ep-flux-diagram">
<h3>Interpreting the EP flux diagram<a class="headerlink" href="#interpreting-the-ep-flux-diagram" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>In the winter hemisphere, the flux is convergent throughout much of the midlatitude troposphere, indicating that the eddy fluxes are acting to decelerate the zonal wind.</p></li>
<li><p>This effect is concentrated into three lobes, respectively centered at roughly (35º, 850 hPa), (50º, 500 hPa) and (20º, 250 hPa) in both winter hemispheres.</p></li>
<li><p>Strongest divergences and convergences occur near the lower boundary.</p>
<ul>
<li><p>Strongly divergent flux in the lowest levels throughout much of the mid-latitudes.</p></li>
<li><p>Consistent with quasi-geostrophic theory in the presence of a meridional temperature gradient, which forces <span class="math notranslate nohighlight">\(F_p\)</span> to zero at the boundary but strongly divergent immediately above the boundary.</p></li>
</ul>
</li>
<li><p>The net effect of the eddy fluxes (in the winter season at least) is a</p>
<ul>
<li><p>deceleration of the zonal wind aloft, and</p></li>
<li><p>acceleration near the surface.</p></li>
</ul>
</li>
<li><p>In other words, the eddies are acting to neutralize the vertical shear, or through the thermal wind balance, to neutralize the meridional temperature gradient.</p></li>
</ul>
<p>The divergence near the boundary does not show a strong seasonal variation. Away from the boundary, the fluxes and their divergences become significantly weaker in the summer season. This is consistent with greater eddy activity in the winter season, especially in the NH.</p>
<p>One of the big advantages of presenting the eddy flux data in the form of EP cross-sections is that it gives us an immediate visual indication of the relative importance of eddy heat and momentum fluxes to the eddy PV flux.</p>
<ul class="simple">
<li><p>Arrows in our EP diagrams are nearly vertical throughout most of the troposphere, indicating the dominance of the eddy heat fluxes.</p></li>
<li><p>The arrows have a horizontal component in the subtropical upper troposphere.</p></li>
<li><p>This is the region where the momentum flux is strongly divergent, as we saw above.</p></li>
</ul>
<p>Our EP flux diagram gives a more complete picture of the eddy forcing of the mean flow than the original Eliassen-Palm cross-sections presented by <span id="id4">Edmon Jr. <em>et al.</em> [<a class="reference internal" href="../info/references.html#id16" title="H. J. Edmon Jr., B.J. Hoskins, and M.E. McIntyre. Eliassen-Palm cross sections for the troposphere. J. Atmos. Sci., 37:2600–2616, 1980. doi:10.1175/1520-0469(1980)037&lt;2600:EPCSFT&gt;2.0.CO;2.">1980</a>]</span>, due to the global span and higher resolution of our data.</p>
</section>
</section>
<section id="the-residual-overturning-from-reanalysis-data">
<h2>The residual overturning from reanalysis data<a class="headerlink" href="#the-residual-overturning-from-reanalysis-data" title="Permalink to this headline">#</a></h2>
<p>We can define a residual mean overturning mass streamfunction <span class="math notranslate nohighlight">\(\psi_{res}\)</span> consistent with our TEM equations, like this:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{2\pi a \cos\phi}{g} v_{res} &amp;= \frac{\partial \psi_{res}}{\partial p} \\
\frac{2\pi a^2 \cos\phi}{g} \omega_{res} &amp;= -\frac{\partial \psi_{res}}{\partial \phi}
\end{align*}\]</div>
<p>To compute and plot <span class="math notranslate nohighlight">\(\psi_{res}\)</span>, we can integrate the <span class="math notranslate nohighlight">\(v\)</span> component in pressure:</p>
<div class="math notranslate nohighlight">
\[\psi_{res} = \frac{2\pi a \cos\phi }{g} \int_0^p v_{res} dp\]</div>
<p>just like we’ve done with other overturning streamfunctions.</p>
<p>The difference here is that <span class="math notranslate nohighlight">\(v_{res}\)</span> is now “corrected” by the eddy heat fluxes:</p>
<div class="math notranslate nohighlight">
\[ v_{res} = [v] - \frac{\partial}{\partial p} \left( \frac{ [v^*\theta^*]}{\sigma} \right) \]</div>
<p>We’ve already computed the neccessary terms for the data, so we can go ahead and take the integral:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_zon</span> <span class="o">=</span> <span class="n">bar</span><span class="p">(</span><span class="n">bracket</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_zon_computed</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="n">v_zon_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_zon</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vres</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="n">vres</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_zon_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">heatflux_computed</span><span class="p">[</span><span class="n">season</span><span class="p">]</span><span class="o">/</span><span class="n">sigma_computed</span><span class="p">[</span><span class="n">season</span><span class="p">])</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi_res</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]:</span>
    <span class="c1"># Use units of 10^9 kg/s</span>
    <span class="n">psi_res</span><span class="p">[</span><span class="n">season</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">coslat</span><span class="o">/</span><span class="n">g</span> <span class="o">*</span> <span class="n">vres</span><span class="p">[</span><span class="n">season</span><span class="p">]</span><span class="o">.</span><span class="n">cumulative_integrate</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;lev&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1E9</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="c1"># Need to multiply by 100 because the &#39;lev&#39; coordinate is in units of hPa, not Pa</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">240</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="n">CSpsi</span> <span class="o">=</span> <span class="n">psi_res</span><span class="p">[</span><span class="n">season</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                       <span class="n">x</span><span class="o">=</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> 
                                       <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">levels</span><span class="o">=</span><span class="n">psi_levels</span><span class="p">,</span>
                                       <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span>
                                            <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CSpsi</span><span class="p">,</span> <span class="n">CSpsi</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Residual mean mass overturning (10^9 kg/s), 2008-2017 </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#cluster.close()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "aug22"
        },
        kernelOptions: {
            kernelName: "aug22",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'aug22'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="hadley.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8. </span>Theories of the Hadley circulation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../assignments/assignment-toa-budget.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Top-of-Atmosphere Radiation Budget and Meridional Energy Transport</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Brian E. J. Rose<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>